function AllPage_OnLoad(){document.activeElement!=null&&document.activeElement.focus()}function AllPage_OnKeyDown(n){var t=!0;switch(n){case 118:t=!1}return t}function SetFocusBTesto(n,t,i,r){var u,f,e;if(f=GetKeyCode(t),f==13){if(e=window.document.getElementById(r),e!=null&&n.value.length!=0)return!1;u=window.document.getElementById(i);u!=null&&u.disabled==!1&&u.focus()}else return!0}function SetFocus(n,t,i){var r,u;u=GetKeyCode(t);u==13&&(r=window.document.getElementById(i),r!=null&&r.disabled==!1&&r.focus())}function GetNextFocus(n){var t=n;do t=t.nextSibling;while(t!=null&&(t.id==""||t.id==undefined||t.nodeType!=1));return t}function GetPreviousFocus(n){var t=n;do t=t.previousSibling;while(t!=null&&(t.id==""||t.id==undefined||t.nodeType!=1));return t}function MBSetColorOnFocus(n,t,i){n.style.backgroundColor=t;n.style.color=i}function GetKeyCode(n){var t;n==null&&(n=window.event);switch(navigator.appName){case K_IE_NAME:t=n.keyCode;break;default:t=n.which}return t}function RND(n,t){var r="",o=-1,f="",e="",h="",c="",s=0,i,u;if(r=n.toString(),r=r.replace(",","."),o=r.indexOf("."),o!=-1?(f=r.substring(0,o),e=r.substring(o+1)):f=r,e.length>t){for(c=e,i="",u=c.length;u>0;u--)i=c.toString().substring(u-1,u),i=parseFloat(i)+s,i=="10"?(s=1,i="0"):s=t>=u?0:Math.round(parseFloat("0."+i)),u<=t&&(h=i+h);f=parseFloat(f)+s;e=h}return parseFloat(f+"."+e)}function trim(n){while(n.substr(0,1)==" ")n=n.subsring(1,n.length);while(n.substr(n.length,1)==" ")n=n.subsring(n.length-1);return n}function msgbox(n){return alert(n),!0}function SelectionStart(n){var r,u,t,i=-1,f,e,o;switch(navigator.appName){case K_IE_NAME:if(r=document.selection.createRange(),u=r.getBookmark(),t=u.charCodeAt(2)-3,i=BrowserVers.indexOf("("),i>-1){f=BrowserVers.substring(i+1,BrowserVers.length-1);e=f.split(";");o=e[1].toString();switch(o){case"MSIE 7.0":return t}}return t+1;default:return n.selectionStart}}function SelectionStartsb(){var i=document.selection.createRange(),r=i.getBookmark(),n=r.charCodeAt(2)-3,t=navigator.appVersion,u=navigator.userAgent.toLowerCase().indexOf("windows nt 6");return u>-1?t.substring(22,25)=="6.0"?n:n+1:t.substring(22,25)=="6.0"?n+1:n}function SelectionLength(n){var r,t="",i=0;switch(navigator.appName){case K_IE_NAME:r=document.selection;t=r.createRange().text;i=t.length;t=document.selection.text;break;default:i=n.selectionEnd-n.selectionStart}return i}function SetSelection(n,t,i){if(navigator.appName==K_IE_NAME){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,i);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0);r.moveEnd("character",i);r.moveStart("character",t);r.select()}}else n.setSelectionRange(t,i)}function SelectAll(n){var t;t=window.document.getElementById(n);t!=null&&SetSelection(t,0,t.value.length)}function SetCurEnd(n){SetSelection(n,n.value.length,n.value.length)}function SetCurBegin(n){SetSelection(n,0,0)}function SetCur(n,t){SetSelection(n,t,t)}function MaxLength(n){switch(navigator.appName){case K_IE_NAME:return n.maxLength;default:return n.maxLength==-1?2147483647:n.maxLength}}function SetCtlFocus(n){var t;t=window.document.getElementById(n);t!=null&&t.disabled==!1&&t.focus()}function OpenDialog(n,t,i,r){var u=window.showModalDialog(t,n,"dialogWidth:"+i+"px; dialogHeight:"+r+"px; center:yes")}function OpenUploader(n,t,i,r,u,f,e){var o=window.showModalDialog(t,n,"dialogWidth:"+i+"px; dialogHeight:"+r+"px; center:yes");return __doPostBack(e.id,u+"|"+f),!0}function OpenWindows(n,t,i){return window.open(n,t,i),!0}function OpenWinEngineReporting(n){return NewWindow=window.open(n,"EngineReporting","height=20,width=20,location=0,status=0,titlebar=0,top=4000"),self.focus(),NewWindow.blur(),!1}function OpenChangeWin(n){return window.location=n,!1}function BOpenPreviewReport(n,t){(n==""||n==null)&&(n="Anteprima di Stampa");(t==""||t==null)&&(t="BSystem/sysPreviewReport.aspx");window.open(t,n)}function BOpenReportRS(n){GetBrowserName()=="Chrome"?OpenChangeWin(n):(OpenWinEngineReporting(n),Timer=setTimeout(function(){CheckUpdateProgressVisibility()},500))}function BDownloadFile(n){OpenChangeWin(n);Timer=setTimeout(function(){CheckUpdateProgressVisibility()},500)}function getScrollTop(){if(typeof pageYOffset!="undefined")return pageYOffset;var t=document.body,n=document.documentElement;return n=n.clientHeight?n:t,n.scrollTop}function getScrollLeft(){if(typeof pageXOffset!="undefined")return pageYOffset;var t=document.body,n=document.documentElement;return n=n.clientWidth?n:t,n.scrollLeft}function ShowMenu(n,t,i,r){var u=t.clientX-i+getScrollLeft()+"px",f=t.clientY-r+getScrollTop()+"px";return document.getElementById(n).style.position="absolute",document.getElementById(n).style.zIndex=5,document.getElementById(n).style.display="inline",document.getElementById(n).style.left=u,document.getElementById(n).style.top=f,!1}function HideMenu(n){document.getElementById(n).style.display="none"}function GetControlsCode(n){var i=window.document.getElementById(K_CONTROLSCODE);if(i==null)return"";var t=i.value,r=t.indexOf("["+n+"]"),u=t.indexOf("[/"+n+"]");return r==-1||u==-1?"":t.substring(r+n.length+2,u)}function SetControlsCode(n,t){var i=window.document.getElementById(K_CONTROLSCODE);return i==null?"":(i.value=i.value+"["+n+"]"+t+"[/"+n+"]",!0)}function AttachCommand(n,t,i){var u=Sys.WebForms.PageRequestManager.getInstance();i==null&&(i="");t=n.toString()+"|"+i.toString()+"|"+t;var r="",e="",f=t.split("|");f.length>2&&(r=f[2]);f.length>3&&(e=f[3]);switch(n){case eTypeCommand_Print:u.add_endRequest(LoadTypeCommand_Print);SetControlsCode(r,t);break;case eTypeCommand_Function:u.add_endRequest(LoadTypeCommand_Function);SetControlsCode(r,t);break;case eTypeCommand_DownloadFile:u.add_endRequest(LoadTypeCommand_DownloadFile);SetControlsCode(r,t);break;case eTypeCommand_PreviewPrint:u.add_endRequest(LoadTypeCommand_PreviewPrint);SetControlsCode(r,t)}return!0}function LoadTypeCommand_Print(n,t){return LoadTypeCommand(n,t,eTypeCommand_Print),!0}function LoadTypeCommand_Function(n,t){return LoadTypeCommand(n,t,eTypeCommand_Function),!0}function LoadTypeCommand_DownloadFile(n,t){return LoadTypeCommand(n,t,eTypeCommand_DownloadFile),!0}function LoadTypeCommand_PreviewPrint(n,t){return LoadTypeCommand(n,t,eTypeCommand_PreviewPrint),!0}function LoadTypeCommand(n,t,i,r){if(n._postBackSettings.sourceElement==null)return!0;if(NewWindow==undefined||NewWindow.closed){var s=GetControlsCode(n._postBackSettings.sourceElement.id),u="",o="",e="",f=s.split("|");f.length>0&&(e=f[0]);f.length>1&&(fncName=f[1]);f.length>2&&(u=f[2]);f.length>3&&(o=f[3]);r==null&&(r="");switch(i){case eTypeCommand_Print:n._postBackSettings.sourceElement.id==u&&u!=""&&n._postBackSettings.sourceElement.id!=""&&e==i&&BOpenReportRS(o);break;case eTypeCommand_Function:n._postBackSettings.sourceElement.id==u&&u!=""&&n._postBackSettings.sourceElement.id!=""&&e==eTypeCommand_Function&&window[r];break;case eTypeCommand_DownloadFile:n._postBackSettings.sourceElement.id==u&&u!=""&&n._postBackSettings.sourceElement.id!=""&&e==eTypeCommand_DownloadFile&&BDownloadFile(o);break;case eTypeCommand_PreviewPrint:n._postBackSettings.sourceElement.id==u&&u!=""&&n._postBackSettings.sourceElement.id!=""&&e==eTypeCommand_PreviewPrint&&BOpenPreviewReport("Anteprima di Stampa",o)}}return!0}function CheckUpdateProgressVisibility(){return NewWindow&&NewWindow.closed?(FirstTime=!0,HideProgressBar()):NewWindow&&(FirstTime&&(ShowProgressBar(),FirstTime=!1),clearTimeout(Timer),Timer=setTimeout(function(){CheckUpdateProgressVisibility()},500)),!0}function setdragitem(n){return dragitem=n,!0}function cleardragitem(){dragitem=undefined}function dodrag(){}function handledragenter(n,t){return n.style["background-color"]="blue",t.preventDefault(),!0}function handledragover(n,t){return t.preventDefault(),!0}function handledragleave(n){n.style["background-color"]=""}function handledrop(n){n.style["background-color"]=""}function BindCheckedTo(n,t,i){var r=!1,f=window.document.getElementById(n),u=window.document.getElementById(t);if(u==null)return!1;switch(i){case eBindToProperty_NONE:r=!0;break;case eBindToProperty_DISPLAY:u.style.display=f.checked?"block":"none";r=!0;break;case eBindToProperty_DISABLED:u.disabled=!f.checked;r=!0}return r}function BrowserDetection(){var o=navigator.appVersion,n=navigator.userAgent,r=navigator.appName,t=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10),e,i,f;(i=n.indexOf("Opera"))!=-1?(r="Opera",t=n.substring(i+6),(i=n.indexOf("Version"))!=-1&&(t=n.substring(i+8))):(i=n.indexOf("MSIE"))!=-1?(r="Microsoft Internet Explorer",t=n.substring(i+5)):(i=n.indexOf("Chrome"))!=-1?(r="Chrome",t=n.substring(i+7)):(i=n.indexOf("Safari"))!=-1?(r="Safari",t=n.substring(i+7),(i=n.indexOf("Version"))!=-1&&(t=n.substring(i+8))):(i=n.indexOf("Firefox"))!=-1?(r="Firefox",t=n.substring(i+8)):(e=n.lastIndexOf(" ")+1)<(i=n.lastIndexOf("/"))&&(r=n.substring(e,i),t=n.substring(i+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName));(f=t.indexOf(";"))!=-1&&(t=t.substring(0,f));(f=t.indexOf(" "))!=-1&&(t=t.substring(0,f));u=parseInt(""+t,10);isNaN(u)&&(t=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10));document.write("Browser name  = "+r+"<br>Full version  = "+t+"<br>Major version = "+u+"<br>navigator.appName = "+navigator.appName+"<br>navigator.userAgent = "+navigator.userAgent+"<br>")}function GetBrowserName(){var o=navigator.appVersion,n=navigator.userAgent,r=navigator.appName,i=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10),e,t,u;return(t=n.indexOf("Opera"))!=-1?(r="Opera",i=n.substring(t+6),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("MSIE"))!=-1?(r="Microsoft Internet Explorer",i=n.substring(t+5)):(t=n.indexOf("Chrome"))!=-1?(r="Chrome",i=n.substring(t+7)):(t=n.indexOf("Safari"))!=-1?(r="Safari",i=n.substring(t+7),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("Firefox"))!=-1?(r="Firefox",i=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(r=n.substring(e,t),i=n.substring(t+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName)),(u=i.indexOf(";"))!=-1&&(i=i.substring(0,u)),(u=i.indexOf(" "))!=-1&&(i=i.substring(0,u)),f=parseInt(""+i,10),isNaN(f)&&(i=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10)),r.toString()}function BSetFocus(n){var t=window.document.getElementById(n);if(t==null)return!1;t.focus()}function BindCheckedPropertyToControl(n,t){var i=window.document.getElementById(n),r=window.document.getElementById(t);return i!=null&&r!=null?(r.disabled=!i.checked,!0):!1}function BGridView_SelectAll(n,t,r){var f=document.getElementById(t),o=document.getElementById(n),u=null,e=null;if(f==null||o==null)return!1;if(f.rows.length>0)for(i=1;i<f.rows.length;i++)for(u=f.rows[i].cells[r],j=0;j<u.childNodes.length;j++)if(u.childNodes[j].type=="checkbox")u.childNodes[j].checked=o.checked;else if(u.childNodes[j].nodeType==1)for(e=u.childNodes[j],k=0;k<e.childNodes.length;k++)e.childNodes[k].type=="checkbox"&&(e.childNodes[k].checked=o.checked);return!0}function BGridViewNoHeader_SelectOne(n,t,r,u,f){var o=document.getElementById(t),s=document.getElementById(n),c=!1,e=null,h=null;if(o==null||s==null)return!1;if(c=u==0?s.checked:!s.checked,o.rows.length>0)for(i=1-f;i<o.rows.length;i++)for(e=o.rows[i].cells[r],j=0;j<e.childNodes.length;j++)if(e.childNodes[j].type=="checkbox"||e.childNodes[j].type=="radio")e.childNodes[j].checked=!1;else if(e.childNodes[j].nodeType==1)for(h=e.childNodes[j],k=0;k<h.childNodes.length;k++)(h.childNodes[k].type=="checkbox"||e.childNodes[j].type=="radio")&&(h.childNodes[k].checked=!1);return s.checked=c,!0}function BGridView_SelectOne(n,t,i,r){return BGridViewNoHeader_SelectOne(n,t,i,r,0)}function BPostBack(n,t,i){var r=n+"|"+t;return __doPostBack(i,r),!0}function BDisplayNone(n){var t=window.document.getElementById(n);return t!=null?(t.style.display="none",!0):!1}function BDisplayBlock(n){var t=window.document.getElementById(n);return t!=null?(t.style.display="block",!0):!1}function BStrDup(n,t){var i="",r;if(n==null)return"";for(r=0;r<t;r++)i=i+n;return i}function BReverse(n){return n.split("").reverse().join("")}function BPrendiNumero(n){var t="";return(n==null||n==undefined||n=="")&&(n="0"),t=n.toString(),t=t.replace(".",""),t=t.replace(",","."),parseFloat(t)}function BFormattaNumero(n,t){var o=0,i="",r="",f="",h="",s="",u=0,e=0;for(n==null&&(n=0),t==null&&(n=2),e=parseFloat(n),e=RND(e,t),e<0?(s="-",i=Math.abs(e).toString()):(s="",i=e.toString()),o=i.indexOf("."),o!=-1?(r=i.toString().substring(o+1),r.length>0&&t>0&&(r=r+BStrDup("0",t-r.length)),i=i.toString().substring(0,o)):r=BStrDup("0",t),o=RND(i.length/3,0),u=i.length;u>0;u--)h=i.substring(u-1,u),u!=i.length&&(u-i.length)%3==0&&(f=f+"."),f=f+h;return r.length>0?s+BReverse(f)+","+r:s+BReverse(f)}function BAggiungiPerCento(n,t){return parseFloat(n)*(1+parseFloat(t)/100)}function BSottraePerCento(n,t){return parseFloat(n)*(1-parseFloat(t)/100)}function BScorporaPerCento(n,t){return parseFloat(n)/(1+parseFloat(t)/100)}function BPerCento(n,t){return parseFloat(n)*parseFloat(t)/100}var K_IE_NAME="Microsoft Internet Explorer",K_OP_NAME="Opera",K_FF_NAME="Firefox",K_SF_NAME="Safari",K_CH_NAME="Chrome",K_NS_NAME="Netscape",K_CONTROLSCODE="ctl00_ControlsCode",NewWindow,Timer=0,FirstTime=!0,eTypeCommand_Print=0,eTypeCommand_Function=1,eTypeCommand_DownloadFile=2,eTypeCommand_PreviewPrint=3,BrowserVers=navigator.appVersion,BrowserName=navigator.appName,ClearEvent=!1,dragitem;window.addEventListener("load",AllPage_OnLoad,!1);dragitem=undefined;var eBindToProperty_NONE=0,eBindToProperty_DISPLAY=1,eBindToProperty_DISABLED=2
function ControllaStato(n){var t=GetNextFocus(this.document.activeElement);__doPostBack(n,"CONTROLLASTATO:"+t.id)}
function MBSetBtnColorOnFocus(n,t,i,r){var u=window.document.getElementById(n),f=window.document.getElementById(t);u.style.backgroundColor=i;u.style.color=r;f.style.color=r}function MBSwapImage(n,t){var i=window.document.getElementById(n);i.style.backgroundImage="url("+t+")"}function BtnKeyDown(n,t,i){var u,r;r=window.document.getElementById(n);u=GetKeyCode(i);switch(u){case 13:t==""?(r.value="INVIO",__doPostBack(r.id,"INVIO")):confirm(t)?(r.value="INVIO",__doPostBack(r.id,"INVIO")):r.value=""}return!0}function BtnTabClick(n,t,i,r,u,f,e,o,s,h){var v,y,p,l,a,w="_left",b="_center",k="_right",c;if(y=window.document.getElementById(i),y!=null){for(p=r.split("|"),a=t.split("|"),l=0;l<=p.length-1;l++)v=window.document.getElementById(p[l].toString()),v!=null&&(v.style.display="none"),c=window.document.getElementById(a[l]+w),c!=null&&(c.className=o),c=window.document.getElementById(a[l]+b),c!=null&&(c.className=s),c=window.document.getElementById(a[l]+k),c!=null&&(c.className=h);y.style.display="block";c=window.document.getElementById(n+w);c!=null&&(c.className=u);c=window.document.getElementById(n+b);c!=null&&(c.className=f);c=window.document.getElementById(n+k);c!=null&&(c.className=e)}}function BToogleClick(n,t,i,r,u,f){var e=window.document.getElementById(n),o,s,h;return e==null?!1:(o=window.document.getElementById(t),o==null)?!1:(s=!1,h=window.document.getElementById(f),h==null)?!1:(h.checked=i,e.disabled!=i&&(s=!0),e.disabled=i,o.disabled=!i,s&&u&&BPostBack(r+"_CheckdChange","",n),!1)}
function mbtTesto_OnChange(n){var t=document.getElementById(n);t.value="change"}function mbtTesto_OnBlur(n,t,i,r){var f=document.getElementById(n),e=document.getElementById(t),u=document.getElementById(i),o=document.getElementById(r);u!=null&&u.value=="change"&&(f.value==""?(u.value="",e.value=""):(u.value="",o.value="C:OnCheckedEvent",__doPostBack(n,"")))}function OkSearch(n,t,i,r,u,f){var e,o;e=window.document.getElementById(f);o=GetKeyCode(t);switch(o){case 13:e.value="C:OkSearchEvent";__doPostBack(f,"");break;case 27:e.value="C:DisabledSearch";__doPostBack(f,"")}}function AbilitaRicerca(n,t,i){var r,u;r=window.document.getElementById(t);u=window.document.getElementById(i);u.value=r.value;r.readOnly=!1;r.style.backgroundColor="white";r.value="";r.focus()}function AbilitaRicercaKey(n,t,i,r,u,f,e){var o,s;o=GetKeyCode(t);switch(o){case f:AbilitaRicerca(n,i,r);break;case e:s=window.document.getElementById(u);s.value="C:SearchAll";__doPostBack(i,"")}}function DisabilitaRicerca(n,t,i,r,u){var f,o,e;if(e=window.document.getElementById(u),f=window.document.getElementById(i),f.readOnly)return!1;f.readOnly=!0;f.style.backgroundColor="whitesmoke";o=window.document.getElementById(r);f.value=e.value;e.value="";n||o.focus()}function TxtLabel_KeyDown(n,t,i,r,u,f){var e,o;e=window.document.getElementById(f);o=GetKeyCode(t);switch(o){case 13:n.readOnly=!0;n.style.backgroundColor="whitesmoke";e.value="R:"+n.value;__doPostBack(r,"");break;case 27:DisabilitaRicerca(!1,n,i,r,u)}}
function LoadGlobalProperty(n,t){var i=MasterPageID+n,r=window.document.getElementById(i+"_"+t);return oRow=window.document.getElementById(i+"_"+hCurrentRow),oCol=window.document.getElementById(i+"_"+hCurrentCol),Col=oCol!=null?parseInt(oCol.value):2,Row=oRow!=null?parseInt(oRow.value):0,r!=null&&(CountRow=r.rows.length,CountCol=r.rows[0].cells.length),oStato=window.document.getElementById(i+"_"+hStato),oComando=window.document.getElementById(i+"_"+hComando),oBColor=window.document.getElementById(i+"_"+hBColor),oFColor=window.document.getElementById(i+"_"+hFColor),!0}function dtg_KeyDown(n,t,i){var f,r=-1,u=-1,e=window.document.getElementById(MasterPageID+n+"_"+t);if(LoadGlobalProperty(n,t),oStato.value!=eMBGStatoVisione)return!1;f=GetKeyCode(i);switch(f){case 37:Col>2?(r=Col-1,u=Row):Row==1?(r=2,u=1):(r=CountCol-1,u=Row-1);break;case 38:Row>1?(u=Row-1,r=Col):Col==2?(r=2,u=1):(r=Col-1,u=1);break;case 39:Col<CountCol-1?(r=Col+1,u=Row):Row==CountRow-1?(r=CountCol-1,u=CountRow-1):(r=2,u=Row+1);break;case 40:Row<CountRow-1?(u=Row+1,r=Col):Col==CountCol-1?(r=CountCol-1,u=CountRow-1):(r=Col+1,u=CountRow-1);break;case 113:case 13:oComando.value="AttivaCella:"+Col+"; "+Row;window.document.forms[0].submit()}SetCurrentCell(e,r,u)}function SetCurrentCell(n,t,i){var r;if(t==-1||i==-1)return!1;Col!=-1&&(r=Col==2?n.rows[Row].cells[CountCol-1].style.backgroundColor:n.rows[Row].cells[2].style.backgroundColor,n.rows[Row].cells[Col].style.backgroundColor=r);n.rows[i].cells[t].style.backgroundColor=oBColor.value;oRow.value=i;oCol.value=t;n.rows[i].cells[0].focus()}function SetFocusCell(n,t,i,r,u){var f=window.document.getElementById(MasterPageID+n+"_"+t);return(LoadGlobalProperty(n,t),u==!0&&oStato.value==eMBGStatoModifica)?!0:(SetCurrentCell(f,i,r),!0)}function LostFocusCell(n,t){var r,i=window.document.getElementById(MasterPageID+n+"_"+t);return LoadGlobalProperty(n,t),Col!=-1&&(r=Col==2?i.rows[Row].cells[CountCol-1].style.backgroundColor:i.rows[Row].cells[2].style.backgroundColor,i.rows[Row].cells[Col].style.backgroundColor=r),!0}function CtlCella_KeyDown(n,t,i,r){var u,e=window.document.getElementById(MasterPageID+t+"_"+i),f=window.document.getElementById(MasterPageID+t+"_"+i+"_"+n);LoadGlobalProperty(t,i);u=GetKeyCode(r);switch(u){case 13:oComando.value="Conferma:"+Col+"; "+Row+"; "+f.value;window.document.forms[0].submit();break;case 27:oStato.value=eMBGStatoVisione;LostFocusCell(t,i);f.style.display="none";SetFocusCell(t,i,Col,Row)}}function ChkCella_KeyDown(n,t,i,r){var f,e=window.document.getElementById(MasterPageID+t+"_"+i),u=window.document.getElementById(MasterPageID+t+"_"+i+"_"+n);LoadGlobalProperty(t,i);f=GetKeyCode(r);switch(f){case 32:u.focus();break;case 13:oComando.value="Conferma:"+Col+"; "+Row+"; "+u.checked;window.document.forms[0].submit();break;case 27:oStato.value=eMBGStatoVisione;LostFocusCell(t,i);u.style.display="none";SetFocusCell(t,i,Col,Row)}}function BFixedHeader(n,t){var i=window.document.getElementById(n),r;if(i!=null&&i.rows[1]!=null&&i.rows[1].cells[1]!=null){for(r=0;r<i.rows[0].cells.length;r++)i.rows[1]!=null&&i.rows[1].cells[1]!=null&&i.rows[1].cells[r].clientWidth!=0&&(i.rows[0].cells[r].style.minWidth=i.rows[1].cells[r].clientWidth-1+"px",i.rows[0].cells[r].style.maxWidth=i.rows[1].cells[r].clientWidth-1+"px",i.rows[0].cells[r].width=i.rows[1].cells[r].clientWidth+"px",i.rows[0].cells[r].style.wordWrap="break-word");return i.rows.length>0&&(i.rows[0].style.width=i.rows[1].clientWidth+"px",i.style.marginTop=i.rows[0].clientHeight+"px",i.rows[0].style.marginTop="-"+(i.rows[0].clientHeight+pageYOffset+2)+"px",t==1&&(i.rows[0].style.marginTop="-"+(i.rows[0].clientHeight+2)+"px"),i.rows[0].style.marginLeft="-2px"),!0}}function BScroll(n,t){var i=window.document.getElementById(n),r=window.document.getElementById(t);return i.rows[0].style.marginTop=r.scrollTop+"px",!0}function BGridView_Click(n,t){return __doPostBack(n,"ROWCLICK|"+t),!0}var hCurrentRow="hCurrentRow",hCurrentCol="hCurrentCol",oRow=null,oCol=null,Row=-1,Col=-1,CountCol=0,CountRow=0,hStato="hStato",oStato=null,eMBGStatoVisione=0,eMBGStatoModifica=1,hBColor="hBColor",hFColor="hFColor",oBColor=null,oFColor=null,hComando="hComando",oComando=null
function OpenFileDialog(n){var t=document.getElementById(n);if(t!=null)return t.click(),!1}function ReadFile(n,t,i,r,u){var f=n.target,e=new FileReader,o;return e.onload=function(n){var u=n.target.result,f=document.getElementById(i),t=document.getElementById(r);return f.src=u,navigator.appName!=K_IE_NAME&&(t.style.display="block"),t.value=u,navigator.appName!=K_IE_NAME&&(t.style.display="none"),!1},f.files[0].size<t?(e.readAsDataURL(f.files[0]),o=document.getElementById(u),o.value=f.files[0].name,alert("file caricato")):alert("File troppo grande."),!1}function ReadFileNoOutput(n,t,i,r,u,f,e){var o=n.target,s=new FileReader,h=document.getElementById(t),c=document.getElementById(u),l=document.getElementById(e);return n.target==null?(alert("Si Ã¨ verificato un errore durante il caricamento del file..."),!1):(o.files[0].size<r?(h.innerText=o.files[0].name,h.className=i,c.value=o.files[0].name,l.style.display="block",s.onloadend=function(n){var t=n.target.result,i=document.getElementById(f);return i.value=t,!1},s.readAsDataURL(o.files[0])):alert("File troppo grande."),!1)}function ReadFileInIE6(n,t,i){try{var o=new ActiveXObject("Scripting.FileSystemObject"),u=o.OpenTextFile(n.srcElement.value,1),f=u.ReadAll();f=ReadAllBytes(n.srcElement.value);var e=f,s=document.getElementById(t),r=document.getElementById(i);return s.src=e,navigator.appName!=K_IE_NAME&&(r.style.display="block"),r.value=e,navigator.appName!=K_IE_NAME&&(r.style.display="none"),u.Close(),!1}catch(h){h.number==-2146827859&&alert('Unable to access local files due to browser security settings. To overcome this, go to Tools->Internet Options->Security->Custom Level. Find the setting for "Initialize and script ActiveX controls not marked as safe" and change it to "Enable" or "Prompt"')}}function ReadAllBytes(n){for(var r=new ActiveXObject("Scripting.FileSystemObject"),t=r.OpenTextFile(n,1),i=[];!t.AtEndOfStream;)i.push(t.Read(1).charCodeAt(0));return t.Close(),i}function GetImage(n,t,i,r,u,f){var e=window.document.getElementById(u);if(e==null)return!1;document.addEventListener("paste",function(){LoadImage(e,n,event,i,r,f)},!1);n.style.display="none";e.style.display="block";e.focus()}function PasteImage_OnBlur(n,t){var i=window.document.getElementById(t);if(i==null)return!1;i.style.display="block";n.style.display="none"}function LoadImage(n,t,i,r,u,f){var e=null,o=null,s,h,c;if(n!=null){if(i.clipboardData!=null&&(e=i.clipboardData),e==null&&i.originalEvent!=null&&i.originalEvent.clipboardData!=null&&(e=i.originalEvent.clipboardData),e==null&&window.clipboardData!=null&&(e=window.clipboardData),e==null){t.style.display="block";n.style.display="none";alert("Paste Image non supportato in questo browser.");return}if(o=e.files||e.items,o==null||o.length==0||o[0].type!="image/png"){alert("Immagine non presente o non supportata");t.style.display="block";n.style.display="none";return}if(s=o[0],s.size==null)for(index in o)h=o[index],h.kind==="file"&&(s=h.getAsFile());c=new FileReader;c.onload=function(n){var i=n.target.result,f=document.getElementById(r),t=document.getElementById(u);return f.src=i,navigator.appName!=K_IE_NAME&&(t.style.display="block"),t.value=i,navigator.appName!=K_IE_NAME&&(t.style.display="none"),!1};s.size==null||s.size<f?(c.readAsDataURL(s),t.style.display="block",n.style.display="none"):alert("Immagine troppo grande.")}}function OnDrop(n,t,i,r,u,f,e){var h=document.getElementById(t),c=document.getElementById(u),l=document.getElementById(e),o,s;n.stopPropagation();n.preventDefault();o=n.dataTransfer.files;o.length>0&&(o[0].size<r?(h.innerText=o[0].name,h.className=i,c.value=o[0].name,l.style.display="block",s=new FileReader,s.onloadend=function(n){var t=n.target.result,i=document.getElementById(f);return i.value=t,!1},s.readAsDataURL(o[0])):alert("File troppo grande."))}function OnDragOver(n){n.stopPropagation();n.preventDefault();n.dataTransfer.dropEffect="copy"}function ActiveListner(n,t,i,r,u,f,e){var o=window.document.getElementById(n);return o==null?!1:(o.addEventListener("dragover",OnDragOver,!1),o.addEventListener("drop",function(){OnDrop(event,t,i,r,u,f,e)},!1),!0)}
function ExpandCollapseCategory(n,t){for(var f,e=n.split("|"),i=window.document.getElementById(t),r="BPropertyGrid_ImgCollapsed",u=0;u<e.length;u++)f=window.document.getElementById(e[u]),f!=null&&i!=null&&(f.style.display=i.className==r?"none":"block");return i.className=i.className==r?"BPropertyGrid_ImgExpand":r,!1}
function MBCharsAllows(n,t,i){var r,u,f,e,o;return(e=SelectionStart(n),o=SelectionLength(n),f=/\d/,r=GetKeyCode(t),u=String.fromCharCode(r),navigator.appName!=K_IE_NAME&&(r==8||r==32||r==0||r==13||r==10))?!0:i.indexOf(u)!=-1?!0:!1}function MBValidateKeyPress(n,t,i,r,u){var c,l,v,e,f,a,o,s,h,y;if(f=SelectionStart(n),a=SelectionLength(n),y=window.document.getElementById(r),MaxLength(n)==undefined)return!0;if(MaxLength(n)<=n.value.length&&a==0)return!1;if(v=/\d/,c=GetKeyCode(u),l=String.fromCharCode(c),navigator.appName!=K_IE_NAME&&(c==8||c==32||c==0||c==13||c==10))return!0;switch(t){case 0:switch(i){case 0:e=!0;break;case 1:o=l.toUpperCase();s=n.value.substring(0,f);h=n.value.substring(f+a);n.value=s+o+h;SetCur(n,f+1);e=!1;break;case 2:o=l.toLowerCase();s=n.value.substring(0,f);h=n.value.substring(f+a);n.value=s+o+h;SetCur(n,f+1);e=!1}break;case 1:e=v.test(l);break;case 2:if(v.test(l))e=!1;else switch(i){case 0:e=!0;break;case 1:o=l.toUpperCase();s=n.value.substring(0,f);h=n.value.substring(f+a);n.value=s+o+h;SetCur(n,f+1);e=!1;break;case 2:o=l.toLowerCase();s=n.value.substring(0,f);h=n.value.substring(f+a);n.value=s+o+h;SetCur(n,f+1);e=!1}}return e?!0:!1}function MBValidateKeyDown(n,t,i){var u,r,f;r=!0;u=GetKeyCode(t);switch(u){case 120:if(ClearEvent)return r;f=window.document.getElementById(i);f!=null&&__doPostBack(n.id,"HELPBUTTON_CLICK");n.focus();ClearEvent=!0}return r}function MBValidateDataOnBlur(n){return n.value=DataValida(n.value),!0}function MBValidateDataKeyDown(n,t){var u,i,f,r;r=!0;i=SelectionStart(n);f=SelectionLength(n);u=GetKeyCode(t);switch(u){case 36:n.value==""?(n.value="",SetCurBegin(n)):SetSelection(n,0,1);r=!1;break;case 35:SelectionLength(n)!=1?n.value==""?(n.value="",SetCurBegin(n)):n.value.length==10?SetSelection(n,9,10):SetSelection(n,n.value.length-1,n.value.length):SetCurEnd(n);r=!1;break;case 37:i>0&&(i=i-1);i>0&&n.value.substring(i,i+1)=="/"&&(i=i-1);SetSelection(n,i,i+1);r=!1;break;case 39:i<n.value.length&&(i=i+1);i<n.value.length&&n.value.substring(i,i+1)=="/"&&(i=i+1);SetSelection(n,i,i+1);r=!1}return r}function MBValidateDataKeyPress(n,t){var f,i,r,e,u;r=SelectionStart(n);e=SelectionLength(n);f=GetKeyCode(t);i=String.fromCharCode(f);switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e==n.value.length&&(n.value="",SetCurBegin(n));sData=n.value;PosCurData=r;AggiungiCarData(n,i);n.value=sData;SetSelection(n,PosCurData,PosCurData+1);u=!1;break;case"-":case"/":SelectionLength(n)==0&&(sData=n.value,PosCurData=r,AggiungiCarData(n,i),n.value=sData);u=!1}return u?!0:!1}function AggiungiCarData(n,t){var r=0,f=0,u=0,i="",e="",o=!0;if(PosCurData==10)return!1;switch(PosCurData){case 0:case 1:if(t=="/")return sData.Length==1&&(sData="0"+sData+"/",PosCurData=3),!1;sData.length>PosCurData?(sData=sData.substring(0,PosCurData)+t+sData.substring(PosCurData+1),sData.length>2&&PosCurData==1&&(PosCurData=PosCurData+1)):(sData=sData+t,PosCurData==1&&(sData=sData+"/",PosCurData=PosCurData+1));PosCurData=PosCurData+1;sData.length>0&&(r=parseInt(sData.substring(0,1)),f=sData.length>1&&sData.length<4?parseInt(sData.substring(1,2)):0,r>3?(PosCurData==1&&(PosCurData=3),i=String(r),e="00",i=e.substring(0,2-i.length)+i,sData=sData.length>1?i+sData.substring(2):i+"/",f>0&&(i=String(f),f>1?(e="00",i=e.substring(0,2-i.length)+i,sData=sData.length>5?sData.substring(0,4)+i+sData:sData.substring(0,2)+"/"+i+"/",PosCurData=6):(sData=sData.length>3?sData.substring(0,3)+i+sData.substring(4):sData.substring(0,2)+"/"+i,PosCurData=4))):r==3&&(f=sData.length>1?parseInt(sData.substring(1,2)):0,f>1&&sData.length<4&&(PosCurData=6,sData="03/0"+sData.substring(1,2)+"/")));o=!1;break;case 2:sData.length==2&&t=="/"&&(sData=sData+"/",PosCurData=PosCurData+1);break;case 3:case 4:if(t=="/")return sData.length==4&&(sData=sData.substring(0,3)+"0"+sData.substring(3,4)+"/",PosCurData=6),!1;sData.length>PosCurData?(sData=sData.substring(0,PosCurData)+t+sData.substring(PosCurData+1),sData.length>5&&PosCurData==4&&(PosCurData=PosCurData+1)):(sData=sData+t,PosCurData==4&&(sData=sData+"/",PosCurData=PosCurData+1));PosCurData=PosCurData+1;sData.length>3&&(r=parseInt(sData.substring(3,4)),r>1&&(i=String(r),i=sData.substring(0,2)+"/0"+i+"/",sData=sData.length>6?i+sData.substring(6):i,PosCurData=6));sData.length>4&&(u=sData.substring(3,5),(u<1||u>12)&&(u<1&&(u=1),u>12&&(u=1,sData.length<7&&(PosCurData=PosCurData+1,sData=sData.substring(0,5)+"/"+sData.substring(4,5))),i=String(u),e="00",i=e.substring(0,2-i.length)+i,sData=sData.substring(0,3)+i+sData.substring(5)));o=!1;break;case 5:sData.length==5&&t=="/"&&(sData=sData+"/",PosCurData=PosCurData+1);break;case 6:case 7:case 8:case 9:if(t=="/")return t=0,!1;sData=sData.length>PosCurData?sData.substring(0,PosCurData)+t+sData.substring(PosCurData+1):sData+t;PosCurData=PosCurData+1;r=sData.length;r==10&&PosCurData==10&&(i=DataValida(sData),sData=i);o=!1;break;default:o=!1}return sData.substring(0,2)=="00"&&(sData="01/"+sData.substring(3)),o}function DataValida(n){var i="",t=0,r=0,u,f="";return n.length>0&&(t=n.indexOf("/"),t>0&&(f=n.substring(t+1),r=f.indexOf("/")+t+1),t>0?(sGiorno=n.substring(0,t),r>t?(sMese=n.substring(t+1,r),sAnno=n.substring(r+1)):(sMese=n.substring(t+1,t+2),sAnno="")):(sGiorno=n.substring(0,2),sMese="",sAnno=""),Convalida(sGiorno,sMese,sAnno),i=sMese+"/"+sGiorno+"/"+sAnno,u=new Date(Date.parse(i)),i=Format(u)),i}function Val(n){var t=0;switch(n){case"01":t=1;break;case"02":t=2;break;case"03":t=3;break;case"04":t=4;break;case"05":t=5;break;case"06":t=6;break;case"07":t=7;break;case"08":t=8;break;case"09":t=9;break;default:t=1}return t}function Format(n){var t="",i="",r="",u="00";return t=String(n.getDate()),t=u.substring(0,2-t.length)+t,i=String(n.getMonth()+1),i=u.substring(0,2-i.length)+i,r=String(n.getFullYear()),t+"/"+i+"/"+r}function Bisestile(n){return n%4!=0?!1:n%100!=0?!0:n%400!=0?!1:!0}function GiorniMese(n,t){return n<1||n>13?0:n==2?Bisestile(t)?29:28:n==4||n==6||n==9||n==11?30:31}function Convalida(n,t,i){var f=0,u=0,r=0,e="",h=0,o=0,c=0,s=new Date,l="";h=s.getDate();o=s.getMonth()+1;c=s.getFullYear();f=n=="09"?9:n=="08"?8:parseInt(n);u=t=="09"?9:t=="08"?8:parseInt(t);r=i=="00"?2e3:i=="08"?2008:i=="09"?2009:parseInt(i);(u<1||u>12)&&(u=o);(n==""||f==0)&&(f=h);(t==""||u==0)&&(u=o);(i==""||r==0)&&(r=c);e=GiorniMese(u,r);f>e&&(f=e);sGiorno=String(f);sMese=String(u);r>=1&&r<=40?(l="00".substring(0,2-String(r).length)+String(r),sAnno="20"+l):sAnno=String(r)}function MBValidateOraOnBlur(n){return n.value=OraValida(n.value),!0}function MBValidateOraKeyDown(n,t,i){var f,r,e,u;u=!0;r=SelectionStart(n);e=SelectionLength(n);f=GetKeyCode(i);switch(f){case 37:return n.value!=""&&(r>0&&(SetSelection(n,r-1,r),u=!1),n.value.substring(r,r+1)==":"&&(SetSelection(n,r-1,r),u=!1)),u;case 39:return n.value!=""&&(r>0&&(SetSelection(n,r+1,r),u=!1),n.value.substring(r,r+1)==":"&&(SetSelection(n,r+1,r),u=!1)),u}return u}function MBValidateOraKeyPress(n,t,i){var e,u,r,o,f;if(r=SelectionStart(n),o=SelectionLength(n),f=!0,n.value.length>=5)return!1;e=GetKeyCode(i);u=String.fromCharCode(e);switch(u){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.value.substring(r,r+1)==":"&&(SetSelection(n,r,r),f=!1);n.value.length==o&&(n.value="");n.value.length==4&&n.value.indexOf(":")+1==0&&(f=!1);switch(r){case 0:u>"2"?(s="0"+u,r=r+1):s=u;s.length<n.value.length&&((s.substring(0,1)="2")?s.substring(1,2)>"3"&&(s=s+n.value.substring(2)):s=s+n.value.substring(r+1));n.value=s.replace("::",":");SetCur(n,r+1);break;case 1:n.value.substring(0,1)>"1"?u>"3"?(s=n.value.substring(0,1)+"3",r=r+1):(s=n.value.substring(0,r)+u,r=r+1):(s=n.value.substring(0,r)+u,r=r+1);s.length<n.value.length&&(s=n.value.substring(r,r+1)==":"?s&":"&n.value.substring(r+1):s&n.value.substring(r+1));n.value=s;n.value.replace("::",":");SetCur(n,r+1);break;case 2:s=u>"5"?n.value.substring(0,2)+":0"+u:n.value.substring(0,2)+":"+u;s.length<n.value.length&&(s=s+n.value.substring(4,5));n.value=s;n.value.replace("::",":");SetCur(n,4);break;case 3:u<"6"&&(s=n.value.substring(0,r)+u);s.length<n.value.length&&(s=s+n.value.substring(r+1));n.value=s;n.value.replace("::",":");SetCur(n,r+1);break;case 4:s=n.value.substring(0,r)+u;s.length<n.value.length&&(s=s+n.value.substring(r+1));n.value=s;n.value.replace("::",":");SetCur(n,r+1);break;default:SetCur(n,n.value.length)}f=!1;break;case":":n.value.length==0&&(r!=2?f=!1:(r=2&&n.value.substring(r,r+1)==":")&&(f=!1));f=!1;break;default:n.value.length>r&&SetSelection(n,r,r+1);f=!1}return f?!0:!1}function OraValida(n){return n}function MBValidateValutaKeyDown(n,t,r){var a,u,h,e,o="",c="",l="",s=0,f=0;if(n.readOnly==!0)return!1;e=!0;u=SelectionStart(n);h=SelectionLength(n);m_CifreDec=t;a=GetKeyCode(r);switch(a){case 45:sfCursorIns?BlockCursor(n):NormalCursor(n);break;case 46:if(h>1&&RimuoviSelezione(n),n.value.substring(u,u+1)==".")return SetSelection(n,u+1,u+2),!1;for(o=LevaSpazi(n.value),i=0;i<u;i++)n.value.substring(i,i+1)=="."&&(f=f+1);for(u=u-f,c=o.substring(0,u),l=o.substring(u+1),o=c+l,n.value=CreaSpazi(o,m_CifreDec),u=u+f,i=0;i<u;i++)n.value.substring(i,i+1)=="."&&(s=s+1);f=s-f;n.value==""&&(n.value="0",sfCursorIns=!0);sfCursorIns?n.value=="0"?SetSelection(n,0,1):SetCur(n,u+f):u==0?SetSelection(n,0,1):SetSelection(n,u+f,u+f+1);e=!1;break;case 8:if(n.length==1||h==n.value.length)n.value="0",SetSelection(n,0,1),e=!1;else{if(sfCursorIns==!1)return RimuoviSelezione(n),NormalCursor(n),!1;for(o=LevaSpazi(n.value),i=0;i<u;i++)n.value.substring(i,i+1)=="."&&(f=f+1);for(u=u-f,h>1?(RimuoviSelezione(n),o=LevaSpazi(n.value),u=u+1):(c=o.substring(0,u-1),l=o.substring(u),o=c+l),n.value=CreaSpazi(o,m_CifreDec),u=u+f,i=0;i<u;i++)n.value.substring(i,i+1)=="."&&(s=s+1);f=s-f;n.value==""&&(n.value="0",sfCursorIns=!0);n.value=="0"?SetSelection(n,0,1):SetCur(n,u+f-1)}e=!1;break;case 36:n.value==""?(n.value="0",SetSelection(n,0,1)):SetSelection(n,0,1);e=!1;break;case 35:n.value==""?(n.value="0",SetSelection(n,0,1)):SetCurEnd(n);e=!1;break;case 37:case 40:return n.value!=""&&u>0&&(sfCursorIns?(SetCur(n,u-1),BlockCursor(n),e=!1):(SetSelection(n,u-1,u),e=!1)),e;case 39:case 38:return n.value!=""&&u<n.value.length&&(sfCursorIns?(u==0?SetCur(n,0):SetCur(n,u+1),BlockCursor(n),e=!1):(SetSelection(n,u+1,u+2),e=!1)),e}return e}function MBValidateValutaKeyPress(n,t,i){var e,f,o,r,u;if(n.readOnly==!0||(o=SelectionStart(n),r=SelectionLength(n),MaxLength(n)<=n.value.length&&r==0))return!1;m_CifreDec=t;e=GetKeyCode(i);f=String.fromCharCode(e);switch(f){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r>1&&RimuoviSelezione(n);n.value==""&&(n.value="0",SetSelection(n,0,1),sfCursorIns=!0);SelectionLength(n)==n.value.length&&(n.value="",SetCurBegin(n));sNumero=n.value;AggiungiCarNum(n,f);u=!1;break;case".":case",":r>1&&RimuoviSelezione(n);n.value==""&&(n.value="0",SetCurBegin(n),sfCursorIns=!0);SelectionLength(n)==n.value.length&&(n.value="0",SetCur(n,1));sNumero=n.value;AggiungiCarNum(n,".");u=!1;break;case"-":SelectionLength(n)==n.value.length?(n.value="-",SetCur(n,1)):n.value.substring(0,1)!="-"&&(sfCursorIns?n.value.length<MaxLength(n)&&(n.value="-"+n.value,SetCur(n,1)):(n.value=LevaSpazi(n.value.substring(1)),n.value=CreaSpazi(n.value,m_CifreDec),n.value="-"+n.value,SetSelection(n,1,2)));u=!1}return u?!0:!1}function AggiungiCarNum(n,t){var r,o=!1,l,f="",s="",h="",u=0,e=0,c="";if(r=SelectionStart(n),l=SelectionLength(n),r==n.value.length){if(o=!0,t==".")return n.value.indexOf(",")!=-1?!1:(n.value=sNumero+",",!1)}else if(t==".")return!1;if(sfCursorIns==!1){if(n.value.substring(r,r+1)==".")return SetSelection(n,r+1,r+2),!1;RimuoviSelezione(n)}if(n.value.indexOf(",")!=-1&&(t==","||t==".")||n.value.indexOf(",")!=-1&&r>n.value.indexOf(",")&&(c=n.value.substring(n.value.indexOf(",")+1),c.length>=m_CifreDec))return!1;for(LungPrima=n.value.length,f=LevaSpazi(n.value),i=0;i<r;i++)n.value.substring(i,i+1)=="."&&(u=u+1);if(r=r-u,s=f.substring(0,r),h=f.substring(r),f=s+t+h,sNumero=CreaSpazi(f,m_CifreDec),LungDopo=sNumero.length,n.value=sNumero,o)SetCurEnd(n),sfCursorIns=!0;else{for(r=r+u,i=0;i<r;i++)n.value.substring(i,i+1)=="."&&(e=e+1);u=e-u;n.value==""&&(n.value="0",sfCursorIns=!0);sfCursorIns?n.value=="0"?SetSelection(n,0,1):SetCur(n,r+u+1):n.value.substring(r+u+1,r+u+2)=="."||n.value.substring(r+u+1,r+u+2)==","?SetSelection(n,r+u+2,r+u+3):SetSelection(n,r+u+1,r+u+2)}return!1}function RimuoviSelezione(n){var r="",u="",t=-1,f=-1,i="";return t=SelectionStart(n),f=SelectionLength(n),r=n.value.substring(0,t),u=n.value.substring(t+f),i=r+u,n.value=i,SetCur(n,t),i}function LevaSpazi(n){for(var t="",t=n;t.indexOf(".")>=0;)t=t.replace(".","");while(t.indexOf(",")>=0)t=t.replace(",",".");return t}function CreaSpazi(n){var e=0,h=0,f="",i=0,o=0,s="",t="",r="",u=0,c=0;if(s="",n=String(n),n.substring(0,1)=="-"&&(s=n.substring(0,1),n=n.substring(1)),u=n.indexOf("."),u>=0){for(t=n.substring(0,u),r=n.substring(u+1,n.length),i=0;i<r.length;i++)if(r.substring(i,i+1)!="0"){c=parseFloat(n);u=n.indexOf(".");u>=0?(t=n.substring(0,u),r=n.substring(u+1)):(t=n,r="");break}}else t=n,r="";if(r=="")t.length>1&&t.substring(0,1)=="0"&&(t=t.substring(1));else if(t.length==0)t="0"&t;else while(t.substring(0,1)=="0"&&t.length>1)t=t.substring(1);if(e=t.length,e>3){h=Math.round(e/3);f=t.substring(t.length-3);i=e-3;do{f="."+f;o=3;do f=t.substring(i-1,i)+f,o=o-1,i=i-1;while(o!=0&&i!=0)}while(i!=0);t=f}return n=r!=""?t+","+r:t,s=="-"&&(n=s+n),n}function NormalCursor(n){var t=0;t=SelectionStart(n);sfCursorIns=!0;SetCur(n,t)}function BlockCursor(n){var t=0;t=SelectionStart(n);sfCursorIns=!1;SetSelection(n,t,t+1)}var sData="",PosCurData=0,sGiorno="",sMese="",sAnno="",sfCursorIns=!0,sNumero="",m_CifreDec=0,PosCur=-1
function NodeTextClick(n,t,i,r){var f=window.document.getElementById(t),u;return f==null?!1:(u=window.document.getElementById(i),u==null)?!1:(u.checked=!u.checked,f.value=r,!0)}function NodeSegnoClick(n,t,i,r,u){var s=window.document.getElementById(t),o,f,e;return s==null?!1:(o=window.document.getElementById(i),o==null)?!1:(f=window.document.getElementById(r),f==null)?!1:(e=window.document.getElementById(u),e==null)?!1:(f.style.display=="none"?(n.src=o.innerText,f.style.display="block",e.checked=!0):(n.src=s.innerText,f.style.display="none",e.checked=!1),!0)}function OnTreeClick(n,t){var i=window.event!=window.undefined?window.event.srcElement:n.target,f=i.tagName.toLowerCase()=="input"&&i.type=="checkbox",u,r;f&&(u=GetParentByTagName("table",i),r=u.nextSibling,r&&r.nodeType==1&&r.tagName.toLowerCase()=="div"&&CheckUncheckChildren(u.nextSibling,i.checked),t||CheckUncheckParents(i,i.checked))}function CheckUncheckChildren(n,t){for(var r=n.getElementsByTagName("input"),u=r.length,i=0;i<u;i++)r[i].checked=t}function CheckUncheckParents(n,t){var o=GetParentByTagName("div",n),f=o.previousSibling,i,e,r,u;if(f){if(t)i=!0;else if(e=AreAllSiblingsNotChecked(n),e)i=!1;else return;r=f.getElementsByTagName("input");r.length>0&&(u=r[0],u.checked=i,CheckUncheckParents(u,i))}}function AreAllSiblingsNotChecked(n){for(var r,i=GetParentByTagName("div",n),u=i.childNodes.length,t=0;t<u;t++)if(i.childNodes[t].nodeType==1&&i.childNodes[t].tagName.toLowerCase()=="table"&&(r=i.childNodes[t].getElementsByTagName("input")[0],r.checked))return!1;return!0}function GetParentByTagName(n,t){for(var i=t.parentNode;i.tagName.toLowerCase()!=n.toLowerCase();)i=i.parentNode;return i}function allowDrop(n,t,i){t!=null&&(t.style["background-color"]=i,t.style.background="linear-gradient(to right,"+i+" 50% , rgba(255,0,0,0) )");n.preventDefault()}function OutDrag(n){n!=null&&(n.style["background-color"]="",n.style.background="")}function drag(n,t,i){var r=t+"~"+i;n.dataTransfer.setData("text",r)}function drop(n,t,i,r){n.preventDefault();var u=t+"|"+n.dataTransfer.getData("text")+"|"+i+"~"+r;__doPostBack(n.target.id,u)}function ChangeProperty(n){var i=window.document.getElementById(n),t=null;i!=null&&(t=i.parentElement,t!=null&&(t.style.maxWidth="24px",t.style.width="24px"));return}
